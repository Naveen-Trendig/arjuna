
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>What are Test Resources? &#8212; Arjuna 1.1.30 documentation</title>
    <link rel="stylesheet" href="_static/flask.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Understanding Configuration System of Arjuna" href="configuration.html" />
    <link rel="prev" title="Tests are Test Functions" href="test_function.html" />
  <script>DOCUMENTATION_OPTIONS.URL_ROOT = './';</script>
   
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Understanding Configuration System of Arjuna"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="test_function.html" title="Tests are Test Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Arjuna 1.1.30 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="what-are-test-resources">
<span id="resources"></span><h1>What are Test Resources?<a class="headerlink" href="#what-are-test-resources" title="Permalink to this headline">¶</a></h1>
<p>More often than not, a test needs one or more resources. It could be a launched browser, an application in a certain state, a database handle and so on.</p>
<p>Such resources at times need to be shared across tests.</p>
<p>In Arjuna you can create resources at various levels and associate them with tests. The Arjuna markup for resources wraps pytest’s corresponding test fixtures.</p>
</div>
<div class="section" id="resource-levels-for-group-for-module-for-test">
<h1>Resource Levels - <strong>&#64;for_group</strong>, <strong>&#64;for_module</strong>, <strong>&#64;for_test</strong><a class="headerlink" href="#resource-levels-for-group-for-module-for-test" title="Permalink to this headline">¶</a></h1>
<p>A resource is defined as a python function (a generator with a single yield to be precise) in Arjuna:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">db</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>

    <span class="n">db_handle</span> <span class="o">=</span> <span class="n">create_db_handle</span><span class="p">()</span>

    <span class="k">yield</span> <span class="n">db_handle</span>

    <span class="n">db_handle</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>In the above dummy resource code:
* There are three logical parts of a resource creator function.
* In first part you create the resource.
* In second part you yield it.
* In third part you clean up the resource.</p>
<p>To tell Arjuna, that it is a resource function, you need to decorate it with resource decorators. There are three of them available:
* <strong>&#64;for_group</strong>: Create a resource at group level, once across all tests in the group.
* <strong>&#64;for_module</strong>: Create a resource at module level, once across all tests in a module.
* <strong>&#64;for_test</strong>: Create a resource for every test.</p>
<dl>
<dt>Following is an example using <strong>&#64;for_test</strong>:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@for_test</span>
<span class="k">def</span> <span class="nf">db</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>

    <span class="n">db_handle</span> <span class="o">=</span> <span class="n">create_db_handle</span><span class="p">()</span>

    <span class="k">yield</span> <span class="n">db_handle</span>

    <span class="n">db_handle</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="module-specific-resources">
<h1><strong>Module-Specific</strong> Resources<a class="headerlink" href="#module-specific-resources" title="Permalink to this headline">¶</a></h1>
<p>You can place the resource functions in a test module python file.</p>
<p>In such a case, these can be used only by the tests present in that module.</p>
</div>
<div class="section" id="cross-module-shared-resources">
<h1><strong>Cross-Module</strong> Shared Resources<a class="headerlink" href="#cross-module-shared-resources" title="Permalink to this headline">¶</a></h1>
<p>You might want to make resource functions available across your project.</p>
<p>To enable this, Arjuna tries to automatically import such resource creators with the following import (assume <cite>testproj</cite> as the project name):</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">testproj.lib.resource</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div></blockquote>
<p>To make use of this feature, you can choose to do one of the following depending on your requirements:</p>
<ul class="simple">
<li><p>If you have used <cite>create-project</cite> command of Arjuna CLI, you will observe that the command creates <strong>&lt;Project Root Directory&gt;/lib/resource.py</strong> module. You can add all resource creators here. They will be automnatically made available for your tests across the test modules in the project.</p></li>
<li><p>For more complex project needs, where the resource creators grow in number, you can convert <strong>resource.py</strong> to a <strong>resource package</strong>. An example of this can be found in the <a class="reference external" href="https://github.com/rahul-verma/arjuna/tree/master/arjuna-samples/arjex">Arjex project on GitHub</a>.</p></li>
</ul>
</div>
<div class="section" id="data-driven-test-resources">
<h1><strong>Data-Driven</strong> Test Resources<a class="headerlink" href="#data-driven-test-resources" title="Permalink to this headline">¶</a></h1>
<p>You can data-drive a test resource as well just like you data-drive a test.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@for_test</span><span class="p">(</span><span class="n">drive_with</span><span class="o">=&lt;</span><span class="n">ds</span><span class="o">&gt;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">db</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>The resource creator function gets as many times as there are records in the data source.</p>
<p>Within the resource, you can act on data to create a custom resource.</p>
<p>The data can be acces from request object as <strong>request.data</strong> as a <strong>DataRecord</strong> object.</p>
</div>
<div class="section" id="associating-a-resource-with-a-test">
<h1><strong>Associating a Resource with a Test</strong><a class="headerlink" href="#associating-a-resource-with-a-test" title="Permalink to this headline">¶</a></h1>
<p>To associate a test resource with a test, pass its name as an argument:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">check_some_sql</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
    <span class="c1">## Now you can act on what db resource yields. E.g.</span>
    <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">some_sql</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Note that if the resource has been created at a higher level already (group/module level), it will not be created again.</p>
</div>
<div class="section" id="setting-a-resource-as-a-default">
<h1>Setting a <strong>Resource as a Default</strong><a class="headerlink" href="#setting-a-resource-as-a-default" title="Permalink to this headline">¶</a></h1>
<p>You might-want to auto-create a resource i.e. make it a default at a certain level. When this is done, you don’t need to pass the resource creator name as an argument to a test function.</p>
<p>Depending upon whether you have put the resource creator in a test module python file or in project library, these default resources are available to in a given module or across the test project.</p>
<p>To make a resource a default, use the <strong>default</strong> keyword argument:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@for_group</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">db</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">db_handle</span> <span class="o">=</span> <span class="n">create_db_handle</span><span class="p">()</span>

    <span class="k">yield</span> <span class="n">db_handle</span>

    <span class="n">db_handle</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</div>


          </div>
        </div>
      </div>
  <span id="sidebar-top"></span>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  
    
  

  <h3>Contents</h3>
  <ul>
<li><a class="reference internal" href="#">What are Test Resources?</a></li>
<li><a class="reference internal" href="#resource-levels-for-group-for-module-for-test">Resource Levels - <strong>&#64;for_group</strong>, <strong>&#64;for_module</strong>, <strong>&#64;for_test</strong></a></li>
<li><a class="reference internal" href="#module-specific-resources"><strong>Module-Specific</strong> Resources</a></li>
<li><a class="reference internal" href="#cross-module-shared-resources"><strong>Cross-Module</strong> Shared Resources</a></li>
<li><a class="reference internal" href="#data-driven-test-resources"><strong>Data-Driven</strong> Test Resources</a></li>
<li><a class="reference internal" href="#associating-a-resource-with-a-test"><strong>Associating a Resource with a Test</strong></a></li>
<li><a class="reference internal" href="#setting-a-resource-as-a-default">Setting a <strong>Resource as a Default</strong></a></li>
</ul>
<h3>Navigation</h3>
<ul>
  <li><a href="index.html">Overview</a>
    <ul>
          <li>Previous: <a href="test_function.html" title="previous chapter">Tests are <strong>Test Functions</strong></a>
          <li>Next: <a href="configuration.html" title="next chapter">Understanding Configuration System of Arjuna</a>
    </ul>
  </li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015-2020, Rahul Verma.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  <script src="_static/version_warning_offset.js"></script>

  </body>
</html>